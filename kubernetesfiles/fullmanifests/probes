probes: it will check the health status of the containers inside pod

1. Readiness probe: It will check whether container is running or not for every 5secs if not will wait for 30 secs 
                    and recreate the container.

2. Liveness probe:  It will check whether container is responding to user request or not for every 5 secs 
                    if not will wait for 30 secs and recreate the container.

3. startup probe : when the new pod is created it will take at least 10 to 30 secs of time until the pod is created startup
                    probe will restrict the readiness and liveness probes to check for health for every 5 secs.
                    Note: This is not used mostly.

---
apiVersion: v1
kind: Pod
metadata:
  name: pod-1
spec:
  containers:
    - name: cont-1
      image: ubuntu
      command: ["/bin/bash", "-c", "touch /opt/myfile; sleep 1000;"]

      livenessProbe:
        exec:
          command:
            - cat
            - /opt/myfile
        initialDelaySeconds: 5
        periodSeconds: 5
        timeoutSeconds: 30
   ----------------------------------------------------------------------------------------------------------------------

Full manifest file for deployment:


apiVersion: apps/v1
kind: Deployment
metadata:
  name: flm
  namespace: dev
spec:
  replicas: 3
  selector:
    matchLabels:
      app: zomato
  template:
    metadata:
      labels:
        app: zomato
    spec:
      containers:
        # Main Application Container
        - name: mycont-1
          image: shaikmustafa/dm
          ports:
            - containerPort: 80
          resources:
            requests:
              cpu: "250m"
              memory: "10Mi"
            limits:
              cpu: "300m"
              memory: "20Mi"

          # ðŸ”¹ Readiness Probe
          readinessProbe:
            httpGet:
              path: /
              port: 80
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 2
            failureThreshold: 3

          # ðŸ”¹ Liveness Probe
          livenessProbe:
            httpGet:
              path: /
              port: 80
            initialDelaySeconds: 15
            periodSeconds: 20
            timeoutSeconds: 2
            failureThreshold: 3

          envFrom:
            - configMapRef:
                name: my-config-map
            - secretRef:
                name: my-secret

          volumeMounts:
            - name: myvolume
              mountPath: "/flm"

        # Sidecar Container
        - name: mycont-2
          image: busybox
          command: ["/bin/sh"]
          args:
            - -c
            - while true; do echo "Sidecar running at $(date)" >> /flm/sidecar.log; sleep 5; done
          volumeMounts:
            - name: myvolume
              mountPath: "/flm"

      volumes:
        - name: myvolume
          persistentVolumeClaim:
            claimName: pvc-1
