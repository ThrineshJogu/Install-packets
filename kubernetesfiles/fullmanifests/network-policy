# denies all inbound and outbound traffic for all pods
we need to install calcio for network policies

---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: deny-all
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress

kubectl get netpol
kubectl delete netpol --all

==========================================================================================================================

first create four pods
client swiggy zomato uber

apiVersion:v1
kind: Pod
metadata:
  name: client
  labels:
    app: client
spec:
  containers:
    - name: cont-1
      image: ngnix
      ports: 
        - containerPort: 80


install ping command first in all pods first

kubectl exec -it client -- apt update -y
kubectl exec -it client -- apt install iputils-ping-y
kubectl exec -it client -- ping google.com

perform above commands for all the pods.

kubectl get po -o wide --show-labels
kubectl exec -it swiggy -- ping pod_ip


*********ingress************
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-swiggy-to-client
spec:
  podSelector:
    matchLabels:
      app: client
  policyTypes:
    - Ingress
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: swiggy


kubectl create -f allow-swiggy-to-client.yml

kubectl exec -it swiggy -- ping podIP(clientIP)

********eggress*********
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-swiggy-egress-to-client
spec:
  podSelector:
    matchLabels:
      app: swiggy
  policyTypes:
    - Egress
  egress:
    - to:
      - podSelector:
          matchLabels:
            app: client



Block all pods:

---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: deny-all
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress























